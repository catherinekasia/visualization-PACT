<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>NeutralinoJs sample app</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="centered-bg">
    <div class="main-layout">
      <aside class="sidebar-nav">
        <nav class="nav-list">
          <a class="nav-item active" href="index.html" title="Map">
            <span class="nav-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#b6c2e2" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6" />
              </svg>
            </span>
          </a>
          <a class="nav-item" href="data.html" title="Data">
            <span class="nav-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#b6c2e2" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="12" width="6" height="8" />
                <rect x="9" y="8" width="6" height="12" />
                <rect x="15" y="4" width="6" height="16" />
              </svg>
            </span>
          </a>
          <a class="nav-item" href="settings.html" title="Settings">
            <span class="nav-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#b6c2e2" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3" />
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33h.09a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51h.09a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82v.09a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z" />
              </svg>
            </span>
          </a>
        </nav>
      </aside>
      <section class="map-section-modern">
        <div class="map-canvas-container-modern">
          <canvas id="map-canvas"></canvas>
          <button id="reset-map-btn" title="Reset map position"
            style="position:absolute;top:16px;right:16px;z-index:10;background:#232b3e;color:#b6c2e2;border:none;border-radius:4px;padding:8px 14px;cursor:pointer;font-size:15px;box-shadow:0 2px 8px #0003;">Reset
            View</button>
        </div>
        <div id="selected-country" class="selected-country-modern"></div>
      </section>
    </div>
    <style>
      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
      }

      body {
        min-height: 100vh;
        min-width: 100vw;
        box-sizing: border-box;
        background: #181f2a;
      }

      .main-layout {
        display: flex;
        height: 100vh;
        width: 100vw;
        overflow: hidden;
      }

      .sidebar-nav {
        width: 64px;
        background: #181f2a;
        color: #fff;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 1.2rem 0 1rem 0;
        box-shadow: 2px 0 8px rgba(0, 0, 0, 0.18);
        z-index: 2;
      }

      .nav-list {
        display: flex;
        flex-direction: column;
        gap: 1.2rem;
        width: 100%;
      }

      .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: #b6c2e2;
        text-decoration: none;
        font-size: 1.5em;
        padding: 0.5em 0;
        border-left: 3px solid transparent;
        transition: background 0.2s, color 0.2s, border-color 0.2s;
        width: 100%;
        position: relative;
      }

      .nav-item.active,
      .nav-item:hover {
        background: #232b3e;
        color: #38bdf8;
        border-left: 3px solid #38bdf8;
      }

      .nav-icon svg {
        display: block;
        margin: 0 auto;
        transition: stroke 0.2s;
      }

      .nav-item.active .nav-icon svg,
      .nav-item:hover .nav-icon svg {
        stroke: #38bdf8;
      }

      .map-section-modern {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: stretch;
        justify-content: stretch;
        background: #232b3e;
        min-width: 0;
        height: 100vh;
        position: relative;
      }

      .map-canvas-container-modern {
        flex: 1;
        display: flex;
        justify-content: stretch;
        align-items: stretch;
        width: 100%;
        height: 100%;
      }

      #map-canvas {
        width: 100%;
        height: 100%;
        border-radius: 0;
        box-shadow: none;
        background: #1a2332;
        display: block;
      }

      .selected-country-modern {
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        margin: 0 auto 1em auto;
        font-size: 1.2em;
        color: #38bdf8;
        text-align: center;
        pointer-events: none;
      }

      /* Popup Modal Styles */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        width: 100vw;
        display: flex;
        align-items: stretch;
        justify-content: center;
        background: rgba(0, 0, 0, 0.8);
        z-index: 1000;
        pointer-events: none;
      }

      .modal-content {
        width: 90%;
        max-width: 600px;
        background: #232b3e;
        border-radius: 8px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        padding: 24px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        pointer-events: auto;
      }

      .close-btn {
        position: absolute;
        top: 16px;
        right: 16px;
        font-size: 2em;
        background: none;
        border: none;
        color: #b6c2e2;
        cursor: pointer;
        z-index: 101;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
      }

      .modal-body {
        flex: 1;
        overflow-y: auto;
      }

      .modal-section {
        margin-bottom: 24px;
      }

      .modal-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 16px;
        margin-bottom: 24px;
      }

      .stat-card {
        background: #2a344d;
        border-radius: 8px;
        padding: 16px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        transition: transform 0.2s;
      }

      .stat-card:hover {
        transform: translateY(-2px);
      }

      .chart-wrapper {
        margin-bottom: 24px;
      }

      /* Right Side Modal Specific Styles */
      .modal-overlay.modal-right {
        position: fixed;
        top: 0;
        right: 0;
        height: 100vh;
        width: 600px;
        min-width: 400px;
        max-width: 100vw;
        display: flex;
        align-items: stretch;
        justify-content: flex-end;
        background: none;
        z-index: 100;
        pointer-events: auto;
        overflow: hidden;
      }

      .modal-overlay.modal-right .modal-content {
        width: 100%;
        height: 100%;
        background: #232b3e;
        box-shadow: -2px 0 12px #0005;
        border-radius: 0;
        display: flex;
        flex-direction: column;
        padding: 32px 24px 24px 24px;
        overflow: hidden;
        font-size: 1.1em;
      }

      .modal-overlay.modal-right .modal-body {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        gap: 18px;
        overflow: hidden;
      }

      .modal-section,
      .modal-grid,
      .modal-charts {
        flex: 0 0 auto;
        margin-bottom: 12px;
        overflow: hidden;
      }

      .modal-charts {
        display: flex;
        flex-direction: row;
        gap: 18px;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: stretch;
        overflow: hidden;
      }

      .chart-wrapper {
        flex: 1 1 48%;
        min-width: 220px;
        max-width: 320px;
        height: 260px;
        background: #1a2332;
        border-radius: 8px;
        padding: 16px;
        box-sizing: border-box;
        overflow: hidden;
      }

      .chart-container {
        width: 100%;
        height: 180px;
        overflow: hidden;
      }

      .modal-header h2 {
        font-size: 2em;
        margin-bottom: 8px;
      }

      .stat-card h4 {
        font-size: 1.1em;
        margin-bottom: 4px;
      }

      @media (max-width: 900px) {
        .modal-overlay.modal-right {
          width: 100vw;
          min-width: 0;
        }

        .chart-wrapper {
          min-width: 140px;
          max-width: 100vw;
          height: 120px;
          padding: 8px;
        }

        .chart-container {
          height: 80px;
        }
      }
    </style>

  </div>
  <!-- Neutralino.js client. This file is gitignored, 
      because `neu update` typically downloads it.
      Avoid copy-pasting it. 
      -->
  <script src="js/neutralino.js"></script>
  <script src="js/d3.v7.min.js"></script>
  <script src="js/components/utils.js"></script>
  <script src="js/components/charts.js"></script>
  <script src="js/components/popup.js"></script>
  <script src="js/components/dataLoader.js"></script>
  <script src="js/components/map.js"></script>
  <script src="js/main.js"></script>

  <!-- Popup Modal (Right Side) -->
  <div id="country-modal" class="modal-overlay modal-right" style="display: none;">
    <div class="modal-content">
      <button id="close-modal" class="close-btn">&times;</button>
      <div class="modal-header">
        <h2 id="modal-country-name">Country Name</h2>
        <div class="happiness-score">
          <span class="score-label">Happiness Index</span>
          <span id="modal-happiness-val" class="score-value">--</span>
        </div>
      </div>
      <div class="modal-body">
        <div class="modal-section">
          <h3>Overview</h3>
          <p id="modal-overview-text">Select a country to see details.</p>
        </div>
        <div class="modal-grid">
          <div class="stat-card">
            <h4>Economy</h4>
            <p id="modal-gdp">GDP: --</p>
          </div>
          <div class="stat-card">
            <h4>Demographics</h4>
            <p id="modal-population">Pop: --</p>
          </div>
          <div class="stat-card">
            <h4>Geography</h4>
            <p id="modal-area">Area: --</p>
          </div>
        </div>
        <div class="modal-charts">
          <div class="chart-wrapper">
            <h3>Quality of Life</h3>
            <div id="chart-radar" class="chart-container"></div>
          </div>
          <div class="chart-wrapper">
            <h3>Economic Indicators</h3>
            <div id="chart-bar" class="chart-container"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>